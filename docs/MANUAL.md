# Manual do Usu√°rio - KL Gestor Pub v1.4.0

## üìñ √çndice

1. [Introdu√ß√£o](#introdu√ß√£o)
2. [Primeiros Passos](#primeiros-passos)
3. [Dashboard](#dashboard)
4. [Gest√£o de Receitas](#gest√£o-de-receitas)
5. [Gest√£o de Despesas](#gest√£o-de-despesas)
6. [Sistema de Categorias](#sistema-de-categorias)
7. [Relat√≥rios](#relat√≥rios)
8. [Auditoria](#auditoria)
9. [Configura√ß√µes](#configura√ß√µes)
10. [FAQ e Troubleshooting](#faq-e-troubleshooting)

---

## üéØ Introdu√ß√£o

O **KL Gestor Pub** √© um sistema completo para gest√£o de contas p√∫blicas municipais, desenvolvido para facilitar o controle financeiro, gera√ß√£o de relat√≥rios e auditoria de opera√ß√µes. Este manual ir√° gui√°-lo atrav√©s de todas as funcionalidades do sistema.

### Caracter√≠sticas Principais:
- ‚úÖ Controle detalhado de receitas e despesas
- ‚úÖ Sistema hier√°rquico de categoriza√ß√£o
- ‚úÖ Relat√≥rios avan√ßados com exporta√ß√£o
- ‚úÖ Auditoria completa de opera√ß√µes
- ‚úÖ Interface em portugu√™s brasileiro
- ‚úÖ Design responsivo para todos os dispositivos

---

## üöÄ Primeiros Passos

### Acesso ao Sistema
1. **Abra seu navegador** e acesse a URL do sistema
2. **Fa√ßa login** com suas credenciais:
   - Email: seu email cadastrado
   - Senha: sua senha pessoal
3. **Aguarde o carregamento** do dashboard principal

### Tipos de Usu√°rio

#### üëë **Administrador**
- Acesso total ao sistema
- Pode criar e gerenciar usu√°rios
- Configura categorias e classifica√ß√µes
- Acessa todas as funcionalidades

#### üë§ **Operador**
- Cadastra receitas e despesas
- Gera relat√≥rios
- Visualiza auditoria
- N√£o pode gerenciar usu√°rios ou configura√ß√µes

---

## üìä Dashboard

O dashboard √© a tela principal do sistema, oferecendo uma vis√£o geral das finan√ßas municipais.

### M√©tricas Principais

#### üí∞ **Cards de Resumo**
- **Receitas do Per√≠odo**: Total de receitas no per√≠odo selecionado
- **Despesas do Per√≠odo**: Total de despesas no per√≠odo selecionado
- **Saldo**: Diferen√ßa entre receitas e despesas
- **Varia√ß√£o %**: Compara√ß√£o com o per√≠odo anterior

#### üìà **Gr√°ficos Interativos**
- **Gr√°fico de Tend√™ncia**: Evolu√ß√£o das receitas e despesas nos √∫ltimos 6 per√≠odos
- **Gr√°fico de Categorias**: Top 5 categorias de despesas do per√≠odo

#### üìã **√öltimas Transa√ß√µes**
- Lista das 5 transa√ß√µes mais recentes
- Tipo (Receita/Despesa), valor e data
- Links diretos para edi√ß√£o

### Filtros de Per√≠odo
- **Mensal**: Dados do m√™s atual vs m√™s anterior
- **Trimestral**: Dados do trimestre atual vs anterior
- **Anual**: Dados do ano atual vs ano anterior

---

## üí∞ Gest√£o de Receitas

### Cadastrando uma Nova Receita

1. **Acesse o menu "Receitas"**
2. **Clique em "Nova Receita"**
3. **Preencha os campos obrigat√≥rios:**
   - **Descri√ß√£o**: Descri√ß√£o clara da receita
   - **Valor**: Valor em reais (use v√≠rgula para decimais)
   - **Data**: Data da receita (n√£o pode ser futura)
   - **Categoriza√ß√£o**: Selecione hierarquicamente:
     - Fonte ‚Üí Bloco ‚Üí Grupo ‚Üí A√ß√£o
   - **Observa√ß√µes**: Campo opcional para detalhes adicionais

4. **Clique em "Salvar"**

### Listagem de Receitas

#### Funcionalidades da Lista:
- **Busca**: Digite qualquer termo para filtrar
- **Ordena√ß√£o**: Clique nos cabe√ßalhos das colunas
- **Pagina√ß√£o**: Navegue entre as p√°ginas
- **A√ß√µes**: Editar ou excluir cada receita

#### Filtros Dispon√≠veis:
- **Por per√≠odo**: Data inicial e final
- **Por categoria**: Fonte, Bloco, Grupo ou A√ß√£o
- **Por valor**: Faixa de valores

### Editando uma Receita

1. **Na listagem**, clique no √≠cone de edi√ß√£o (‚úèÔ∏è)
2. **Modifique os campos** desejados
3. **Clique em "Atualizar"**

> ‚ö†Ô∏è **Importante**: Todas as altera√ß√µes s√£o registradas no log de auditoria

### Excluindo uma Receita

1. **Na listagem**, clique no √≠cone de exclus√£o (üóëÔ∏è)
2. **Confirme a exclus√£o** no modal
3. **A receita ser√° removida** permanentemente

---

## üí∏ Gest√£o de Despesas

### Cadastrando uma Nova Despesa

1. **Acesse o menu "Despesas"**
2. **Clique em "Nova Despesa"**
3. **Preencha os campos obrigat√≥rios:**
   - **Descri√ß√£o**: Descri√ß√£o clara da despesa
   - **Valor**: Valor em reais (use v√≠rgula para decimais)
   - **Data**: Data da despesa (n√£o pode ser futura)
   - **Categoriza√ß√£o**: Selecione hierarquicamente:
     - Fonte ‚Üí Bloco ‚Üí Grupo ‚Üí A√ß√£o
   - **Classifica√ß√£o**: Tipo de despesa (Corrente, Capital, etc.)
   - **Observa√ß√µes**: Campo opcional para detalhes adicionais

4. **Clique em "Salvar"**

### Diferen√ßas das Receitas

- **Campo adicional**: Classifica√ß√£o de Despesa
- **Valida√ß√µes espec√≠ficas**: Regras de neg√≥cio para despesas p√∫blicas
- **Relat√≥rios especializados**: Relat√≥rios por classifica√ß√£o

---

## üè∑Ô∏è Sistema de Categorias

### Estrutura Hier√°rquica

O sistema utiliza uma estrutura de 4 n√≠veis:

```
Fonte (N√≠vel 1)
‚îî‚îÄ‚îÄ Bloco (N√≠vel 2)
    ‚îî‚îÄ‚îÄ Grupo (N√≠vel 3)
        ‚îî‚îÄ‚îÄ A√ß√£o (N√≠vel 4)
```

### Exemplos Pr√°ticos:

**Receitas:**
- Fonte: "Receitas Correntes"
  - Bloco: "Receita Tribut√°ria"
    - Grupo: "Impostos"
      - A√ß√£o: "IPTU"

**Despesas:**
- Fonte: "Despesas Correntes"
  - Bloco: "Pessoal e Encargos"
    - Grupo: "Pessoal Civil"
      - A√ß√£o: "Vencimentos e Vantagens Fixas"

### Gerenciando Categorias (Admin)

#### Criando uma Nova Categoria:
1. **Acesse "Categorias"**
2. **Clique em "Nova Categoria"**
3. **Preencha:**
   - Nome da categoria
   - C√≥digo (opcional)
   - Tipo (fonte, bloco, grupo, a√ß√£o)
   - Categoria pai (se aplic√°vel)
4. **Salve a categoria**

#### Sele√ß√£o Din√¢mica:
- As subcategorias s√£o carregadas automaticamente
- Apenas categorias ativas s√£o exibidas
- Valida√ß√£o de hierarquia √© aplicada

---

## üìä Relat√≥rios

### Tipos de Relat√≥rios Dispon√≠veis

#### 1. **Relat√≥rio de Receitas**
- Lista todas as receitas do per√≠odo
- Agrupamento por data/per√≠odo
- Totalizadores por categoria

#### 2. **Relat√≥rio de Despesas**
- Lista todas as despesas do per√≠odo
- Inclui classifica√ß√£o de despesas
- An√°lise por categoria e classifica√ß√£o

#### 3. **Relat√≥rio de Balan√ßo**
- Comparativo receitas vs despesas
- C√°lculo autom√°tico do saldo
- An√°lise de varia√ß√µes

#### 4. **Relat√≥rio por Classifica√ß√£o de Despesas**
- Agrupamento por tipo de despesa
- An√°lise de distribui√ß√£o
- Comparativos percentuais

### Gerando um Relat√≥rio

1. **Acesse o menu "Relat√≥rios"**
2. **Selecione o tipo de relat√≥rio**
3. **Configure os par√¢metros:**
   - **Per√≠odo**: Data inicial e final
   - **Agrupamento**: Di√°rio, Mensal ou Anual
   - **Filtros** (opcionais):
     - Fonte, Bloco, Grupo, A√ß√£o
     - Classifica√ß√£o de despesa
4. **Escolha o formato:**
   - Visualizar na tela
   - Exportar para PDF
   - Exportar para Excel
5. **Clique em "Gerar Relat√≥rio"**

### Formatos de Agrupamento

#### üìÖ **Di√°rio**
- Dados agrupados por dia
- Formato: dd/mm/yyyy
- Ideal para an√°lises detalhadas

#### üìÜ **Mensal**
- Dados agrupados por m√™s
- Formato: mm/yyyy
- Ideal para acompanhamento mensal

#### üóìÔ∏è **Anual**
- Dados agrupados por ano
- Formato: yyyy
- Ideal para an√°lises de longo prazo

### üìÑ Exporta√ß√£o para PDF

#### Caracter√≠sticas dos PDFs:
- **Layout Profissional**: Cabe√ßalho com logo e informa√ß√µes municipais
- **Dados Completos**: Fonte, Bloco, Grupo, A√ß√£o para cada item
- **Formata√ß√£o Brasileira**: 
  - Valores em R$ (Real brasileiro)
  - Datas no formato dd/mm/yyyy
- **Totalizadores**: Valores totais ao final do relat√≥rio
- **Filtros Aplicados**: Mostrados no cabe√ßalho para refer√™ncia
- **Pagina√ß√£o**: Numera√ß√£o autom√°tica de p√°ginas

#### Quando Usar PDF:
- Apresenta√ß√µes oficiais
- Arquivo para impress√£o
- Documenta√ß√£o formal
- Presta√ß√£o de contas

### üìä Exporta√ß√£o para Excel

#### Caracter√≠sticas dos Excels:
- **Dados Estruturados**: Planilha organizada com cabe√ßalhos
- **Totalizadores**: Valores totais calculados automaticamente
- **Formata√ß√£o**: Valores monet√°rios e datas formatados
- **Filtros**: Informa√ß√µes sobre filtros aplicados
- **Edit√°vel**: Permite an√°lises adicionais

#### Quando Usar Excel:
- An√°lises detalhadas
- Cruzamento de dados
- Gr√°ficos personalizados
- Relat√≥rios internos

### üí° Dicas para Relat√≥rios

- **Performance**: Evite per√≠odos muito longos com agrupamento di√°rio
- **Filtros**: Use filtros para focar em categorias espec√≠ficas
- **Compara√ß√£o**: Gere relat√≥rios de per√≠odos similares para comparar
- **Backup**: Mantenha c√≥pias dos relat√≥rios importantes

---

## üîç Auditoria

O sistema de auditoria registra todas as opera√ß√µes realizadas, garantindo transpar√™ncia e rastreabilidade.

### O que √© Registrado

#### üìù **Opera√ß√µes Auditadas:**
- Cria√ß√£o, edi√ß√£o e exclus√£o de receitas
- Cria√ß√£o, edi√ß√£o e exclus√£o de despesas
- Altera√ß√µes em categorias (admin)
- Cria√ß√£o e edi√ß√£o de usu√°rios (admin)
- Mudan√ßas em configura√ß√µes (admin)

#### üìä **Informa√ß√µes Registradas:**
- **Usu√°rio**: Quem realizou a a√ß√£o
- **A√ß√£o**: Tipo de opera√ß√£o (criar, editar, excluir)
- **Data/Hora**: Timestamp preciso da opera√ß√£o
- **Dados Antigos**: Valores antes da altera√ß√£o
- **Dados Novos**: Valores ap√≥s a altera√ß√£o
- **IP**: Endere√ßo IP do usu√°rio

### Acessando os Logs de Auditoria

1. **Acesse o menu "Auditoria"**
2. **Visualize a timeline** de opera√ß√µes
3. **Use os filtros** para encontrar registros espec√≠ficos:
   - Por usu√°rio
   - Por per√≠odo
   - Por tipo de a√ß√£o
   - Por modelo (receita, despesa, etc.)

### Interpretando os Logs

#### üü¢ **Cria√ß√£o (Create)**
- √çcone: ‚ûï
- Cor: Verde
- Mostra todos os dados do novo registro

#### üü° **Edi√ß√£o (Update)**
- √çcone: ‚úèÔ∏è
- Cor: Amarelo
- Mostra compara√ß√£o antes/depois

#### üî¥ **Exclus√£o (Delete)**
- √çcone: üóëÔ∏è
- Cor: Vermelho
- Mostra todos os dados do registro exclu√≠do

### Detalhes Expandidos

- **Clique em qualquer log** para ver detalhes completos
- **Compare valores** lado a lado
- **Veja metadados** como IP e user agent

---

## ‚öôÔ∏è Configura√ß√µes

### Configura√ß√µes Municipais (Admin)

#### Dados do Munic√≠pio:
1. **Acesse "Configura√ß√µes" ‚Üí "Munic√≠pio"**
2. **Preencha as informa√ß√µes:**
   - Nome do munic√≠pio
   - Nome da prefeitura
   - Endere√ßo completo
   - C√≥digo IBGE
   - Estado (UF)
   - CEP
   - Telefone
   - Email institucional
   - Nome do prefeito

3. **Salve as altera√ß√µes**

> üí° **Dica**: Essas informa√ß√µes aparecem nos relat√≥rios em PDF

### Gest√£o de Usu√°rios (Admin)

#### Criando um Novo Usu√°rio:
1. **Acesse "Usu√°rios"**
2. **Clique em "Novo Usu√°rio"**
3. **Preencha:**
   - Nome completo
   - Email (ser√° o login)
   - Senha tempor√°ria
   - Tipo (Admin ou Operador)
   - Status (Ativo/Inativo)

4. **Salve o usu√°rio**

#### Editando Usu√°rios:
- **Alterar dados**: Nome, email, tipo
- **Resetar senha**: Gerar nova senha tempor√°ria
- **Ativar/Desativar**: Controlar acesso ao sistema

#### Tipos de Usu√°rio:

**üëë Administrador:**
- Acesso total ao sistema
- Pode gerenciar outros usu√°rios
- Configura categorias e classifica√ß√µes
- Acessa configura√ß√µes municipais

**üë§ Operador:**
- Cadastra receitas e despesas
- Gera relat√≥rios
- Visualiza auditoria
- Edita pr√≥prio perfil

### Perfil do Usu√°rio

#### Alterando Dados Pessoais:
1. **Clique no seu nome** (canto superior direito)
2. **Selecione "Perfil"**
3. **Edite:**
   - Nome
   - Email
4. **Salve as altera√ß√µes**

#### Alterando Senha:
1. **No perfil**, clique em "Alterar Senha"
2. **Preencha:**
   - Senha atual
   - Nova senha
   - Confirma√ß√£o da nova senha
3. **Salve a nova senha**

---

## üÜò FAQ e Troubleshooting

### Perguntas Frequentes

#### ‚ùì **Posso cadastrar receitas/despesas futuras?**
**R:** N√£o, o sistema n√£o permite datas futuras para manter a integridade dos dados financeiros.

#### ‚ùì **Como funciona a hierarquia de categorias?**
**R:** Fonte ‚Üí Bloco ‚Üí Grupo ‚Üí A√ß√£o. Cada n√≠vel depende do anterior, e a sele√ß√£o √© din√¢mica.

#### ‚ùì **Posso excluir uma categoria que est√° sendo usada?**
**R:** N√£o, categorias com receitas/despesas associadas n√£o podem ser exclu√≠das.

#### ‚ùì **Os relat√≥rios t√™m limite de dados?**
**R:** N√£o h√° limite, mas per√≠odos muito longos podem demorar para processar.

#### ‚ùì **Como recuperar uma receita/despesa exclu√≠da?**
**R:** N√£o √© poss√≠vel recuperar. Use os logs de auditoria para ver os dados e recadastre se necess√°rio.

### Problemas Comuns

#### üîß **Sistema lento ou n√£o carrega**
**Solu√ß√µes:**
1. Limpe o cache do navegador
2. Verifique sua conex√£o com a internet
3. Tente usar outro navegador
4. Entre em contato com o suporte

#### üîß **Erro ao salvar dados**
**Solu√ß√µes:**
1. Verifique se todos os campos obrigat√≥rios est√£o preenchidos
2. Confirme se as datas est√£o no formato correto
3. Verifique se os valores n√£o t√™m caracteres especiais
4. Tente novamente ap√≥s alguns minutos

#### üîß **N√£o consigo gerar relat√≥rios**
**Solu√ß√µes:**
1. Verifique se o per√≠odo selecionado tem dados
2. Confirme se os filtros n√£o est√£o muito restritivos
3. Tente um per√≠odo menor
4. Verifique sua permiss√£o de usu√°rio

#### üîß **Categorias n√£o carregam dinamicamente**
**Solu√ß√µes:**
1. Recarregue a p√°gina
2. Verifique se h√° categorias cadastradas no n√≠vel superior
3. Confirme se as categorias est√£o ativas
4. Limpe o cache do navegador

### Navegadores Suportados

‚úÖ **Recomendados:**
- Google Chrome 90+
- Mozilla Firefox 88+
- Microsoft Edge 90+
- Safari 14+

‚ö†Ô∏è **Limita√ß√µes:**
- Internet Explorer n√£o √© suportado
- Vers√µes muito antigas podem ter problemas

### Contato e Suporte

üìß **Email**: rayhenrique@gmail.com  
üåê **GitHub**: https://github.com/rayhenrique/klgestorpub  
üì± **Suporte**: Entre em contato para d√∫vidas t√©cnicas

---

## üìã Hist√≥rico de Vers√µes

### üöÄ **Vers√£o 1.4.0 (Janeiro 2025) - ATUAL**
**Arquitetura Completamente Reestruturada**
- ‚úÖ **Migra√ß√£o Limpa**: Removida arquitetura obsoleta da tabela `transactions`
- ‚úÖ **Tabelas Especializadas**: Separa√ß√£o clara entre `revenues` e `expenses`
- ‚úÖ **Performance Otimizada**: Consultas mais eficientes e relacionamentos otimizados
- ‚úÖ **Estabilidade Total**: Zero conflitos de foreign key constraints
- ‚úÖ **C√≥digo Limpo**: Remo√ß√£o de 262 linhas de c√≥digo obsoleto
- ‚úÖ **Documenta√ß√£o Completa**: Manual atualizado, PRD e documenta√ß√£o t√©cnica
- ‚úÖ **GitHub Sincronizado**: Reposit√≥rio atualizado com todas as corre√ß√µes

### üìä **Vers√£o 1.3.0 (Agosto 2025)**
**Valida√ß√£o e Testes Aprimorados**
- Form Request Classes para valida√ß√£o robusta
- Suite completa de testes com PHPUnit
- Service Layer para melhor organiza√ß√£o
- Factories para dados de teste
- Valida√ß√£o em portugu√™s brasileiro

### üîß **Vers√£o 1.2.0 (Fevereiro 2025)**
**Melhorias em Relat√≥rios**
- Relat√≥rios em PDF com layout otimizado
- Formata√ß√£o brasileira de datas e valores
- Adi√ß√£o de colunas detalhadas (Fonte, Bloco, Grupo, A√ß√£o)
- Simplifica√ß√£o do sistema de relat√≥rios
- Foco em relat√≥rios essenciais

### üèóÔ∏è **Vers√£o 1.1.0 (Janeiro 2024)**
**Auditoria e Interface**
- Sistema completo de logs de auditoria
- Melhorias na interface do usu√°rio
- Relat√≥rios avan√ßados implementados
- Sistema de backup autom√°tico
- Documenta√ß√£o inicial do sistema

### üéØ **Vers√£o 1.0.0 (Janeiro 2024)**
**Lan√ßamento Inicial**
- Sistema b√°sico de receitas e despesas
- Categorias hier√°rquicas implementadas
- Relat√≥rios financeiros b√°sicos
- Autentica√ß√£o e autoriza√ß√£o
- Configura√ß√µes por munic√≠pio

---

## üìû Suporte e Contato

### üõ†Ô∏è **Suporte T√©cnico**
- **Email**: rayhenrique@gmail.com
- **Resposta**: At√© 24 horas em dias √∫teis
- **Hor√°rio**: Segunda a Sexta, 8h √†s 18h

### üìö **Recursos Adicionais**
- **Documenta√ß√£o T√©cnica**: Dispon√≠vel no reposit√≥rio
- **C√≥digo Fonte**: GitHub - rayhenrique/klgestorpub
- **Atualiza√ß√µes**: Notifica√ß√µes autom√°ticas no sistema

### üîÑ **Atualiza√ß√µes do Sistema**
O sistema √© atualizado regularmente com:
- Corre√ß√µes de bugs
- Melhorias de performance
- Novas funcionalidades
- Atualiza√ß√µes de seguran√ßa

---

**¬© 2025 KL Gestor Pub v1.4.0**  
**Desenvolvido por Ray Henrique**  
**Todos os direitos reservados**